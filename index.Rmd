---
title: "Evolution of the NBA In the Past Decade"
author: "Teddy B., Kevin J., Kevin M."
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    thumbnails: false
    highlight: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
library(tidyverse)
library(dplyr)
library(tidyr)
library(kableExtra)
```

# Introduction

# Shot Data and Mapping

## Shot Data using `ballr` package and the NBA API

# Player Season Data

# Shot Type Graph and Table

```{r, line_graph, echo = FALSE, message = FALSE}
df <- read.csv("../Data/total_shot_data.csv") %>%
  select(-c(X))
shot_zone_basic_list = c("Above the Break 3", "Backcourt", "In The Paint (Non-RA)", "Left Corner 3", "Mid-Range", "Restricted Area", "Right Corner 3")

season_zones <- df %>%
  group_by(season, shot_zone_basic) %>%
  summarise(
    count = n()
  ) %>% 
  filter(shot_zone_basic %in% shot_zone_basic_list) %>%
  mutate(shot_zone = case_when(grepl("3", shot_zone_basic) ~ "Three-pointers",
                               shot_zone_basic == "Backcourt" ~ "Three-pointers",
                               TRUE ~ shot_zone_basic)) %>%
  group_by(season, shot_zone) %>%
  summarise(
    count = sum(count)
  ) 

season_totals <- season_zones %>%
  group_by(season) %>%
  summarise(
    shot_zone = "total",
    count = sum(count)
  )

season_zones <- rbind(season_zones, season_totals)
season_zones_table <- season_zones %>%
  pivot_wider(
    names_from = shot_zone,
    values_from = count
  ) 
season_zones_table %>%
  mutate(
    across(c(1:4), .fns = ~./total)
  ) %>%
  select(-c(total)) %>%
  pivot_longer(
    cols = 2:5,
    names_to = "shot_zone",
    values_to = "percentage",
  ) %>%
  rowwise() %>%
  mutate(year = as.numeric(strsplit(season, "-")[[1]][1])) %>%
  ggplot(mapping = aes(x = year, y = percentage, color = shot_zone)) +
  geom_line() + 
  scale_y_continuous(labels = scales::percent) +
  scale_x_continuous(breaks = c(2010, 2012, 2014, 2016, 2018, 2020)) + 
  labs(
    title = "\n Percentages of Shots Taken In Each Area Each Season",
    subtitle = "From 2010-2021",
    color = "Shot Zone Area",
    y = "\nPercentages\n",
    x = "\nYear\n"
  )
```

```{r, table, echo = FALSE}
season_zones_table %>% 
  rename(Season = season) %>%
  kable()
```

# Heat Map

![heatmap](heatmap.gif)


# You can even create tabs if you want! {.tabset .tabset-fade .tabset-pills}

## Bulleted list

You can make a bulleted list like this:

- item 1
- item 2
- item 3


## Numbered list

You can make a numbered list like this

1. First thing I want to say
2. Second thing I want to say
3. Third thing I want to say

